# 环境调度配置


### 迁移说明

1. 如果您默认接入了权限中心，在迁移`服务/用户组`实例至目标项目的同时，会将该`服务/用户组`实例的权限一并迁移到目标项目，并为迁移者添加该`服务/用户组`实例的相关权限
2. 除迁移者和实例创建者外，其他用户将失去该`服务/用户组`实例的相关权限，需要重新申请。

3. 迁移者在迁移`服务/用户组`实例前，需确认自己是否拥有满足以下条件：
   * 迁移`服务`需要的权限：拥有**服务管理**，**工单查看**权限，以上权限需在权限中心申请
   * 迁移`用户组`需要的权限：为该`用户组`实例的**创建者**

4. 迁移`服务`实例到目标项目时，会将`服务`所关联的目录信息一并迁移，若目标项目无匹配的目录，则会在目标项目下新建目录



### 迁移API

- 请求方法及URL

```
POST {BK_PAAS_HOST}/api/project/projects/migration_project/
```

- 请求参数示例

```json
{
    "resource_type": "service",
    "resource_id":2,
    "old_project_key":0,
    "new_project_key":"test_project"
}
```

- 请求参数说明

| 字段            | 类型       | 描述                                                         | 是否必填 |
| --------------- | ---------- | ------------------------------------------------------------ | -------- |
| resource_type   | string     | 资源类型，可选项：("service", "服务"), ("user_group", "用户组") | 是       |
| resource_id     | int        | 资源实例ID                                                   | 是       |
| old_project_key | string/int | 迁移前资源所在项目代号，默认项目代号为0（整型）              | 是       |
| new_project_key | string     | 迁移目标项目代号                                             | 是       |


- 返回结果示例

```json
{
    "result": true,
    "code": "OK",
    "message": "success",
    "data": []
}
```

- 返回结果参数说明

| 字段    | 类型   | 描述                              |
| ------- | ------ | --------------------------------- |
| result  | bool   | 返回结果，true为成功，false为失败 |
| code    | int    | 返回码，0表示成功，其他值表示失败 |
| message | string | 请求返回信息                      |
| data    | list   | 结果                              |



